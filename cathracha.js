
	var cities = [
  {
	"City": "Palma de Mallorca",
	"Country": "Spain",
	"Population": "301,000"
  },
  {
	"City": "Grodno",
	"Country": "Belarus",
	"Population": "301,000"
  },
  {
	"City": "Bonn",
	"Country": "Germany",
	"Population": "301,000"
  },
  {
	"City": "Vologda",
	"Country": "Russia",
	"Population": "300,000"
  },
  {
	"City": "Varna",
	"Country": "Bulgaria",
	"Population": "299,000"
  },
  {
	"City": "Venezia",
	"Country": "Italy",
	"Population": "297,000"
  },
  {
	"City": "Zhitomir",
	"Country": "Ukraine",
	"Population": "297,000"
  },
  {
	"City": "Belfast",
	"Country": "UK",
	"Population": "297,000"
  },
  {
	"City": "Sumy",
	"Country": "Ukraine",
	"Population": "296,000"
  },
  {
	"City": "Leicester",
	"Country": "UK",
	"Population": "294,000"
  },
  {
	"City": "Komsomolsk-na-Amure",
	"Country": "Russia",
	"Population": "294,000"
  },
  {
	"City": "Sunderland",
	"Country": "UK",
	"Population": "294,000"
  },
  {
	"City": "Sandwell",
	"Country": "UK",
	"Population": "292,000"
  },
  {
	"City": "Doncaster",
	"Country": "UK",
	"Population": "292,000"
  },
  {
	"City": "Stockport",
	"Country": "UK",
	"Population": "291,000"
  },
  {
	"City": "Sefton",
	"Country": "UK",
	"Population": "290,000"
  },
  {
	"City": "Kostroma",
	"Country": "Russia",
	"Population": "287,000"
  },
  {
	"City": "Vigo",
	"Country": "Spain",
	"Population": "286,000"
  },
  {
	"City": "Århus",
	"Country": "Denmark",
	"Population": "286,000"
  },
  {
	"City": "Brest",
	"Country": "Belarus",
	"Population": "286,000"
  },
  {
	"City": "Volzhsky",
	"Country": "Russia",
	"Population": "286,000"
  },
  {
	"City": "Taganrog",
	"Country": "Russia",
	"Population": "285,000"
  },
  {
	"City": "Bialystok",
	"Country": "Poland",
	"Population": "284,000"
  },
  {
	"City": "Nottingham",
	"Country": "UK",
	"Population": "284,000"
  },
  {
	"City": "Petrozavodsk",
	"Country": "Russia",
	"Population": "282,000"
  },
  {
	"City": "Newcastle-upon-Tyne",
	"Country": "UK",
	"Population": "282,000"
  },
  {
	"City": "Gelsenkirchen",
	"Country": "Germany",
	"Population": "282,000"
  },
  {
	"City": "Bratsk",
	"Country": "Russia",
	"Population": "279,000"
  },
  {
	"City": "Dzerzhinsk",
	"Country": "Russia",
	"Population": "278,000"
  },
  {
	"City": "Surgut",
	"Country": "Russia",
	"Population": "277,000"
  },
  {
	"City": "Karlsruhe",
	"Country": "Germany",
	"Population": "277,000"
  },
  {
	"City": "Orsk",
	"Country": "Russia",
	"Population": "274,000"
  },
  {
	"City": "Porto",
	"Country": "Portugal",
	"Population": "273,000"
  },
  {
	"City": "Alicante",
	"Country": "Spain",
	"Population": "272,000"
  },
  {
	"City": "Dneprodzerzhinsk",
	"Country": "Ukraine",
	"Population": "270,000"
  },
  {
	"City": "Wiesbaden",
	"Country": "Germany",
	"Population": "268,000"
  },
  {
	"City": "Kirovograd",
	"Country": "Ukraine",
	"Population": "267,000"
  },
  {
	"City": "Kingston-upon-Hull",
	"Country": "UK",
	"Population": "266,000"
  },
  {
	"City": "Novi Sad",
	"Country": "Serbia",
	"Population": "266,000"
  },
  {
	"City": "Bolton",
	"Country": "UK",
	"Population": "265,000"
  },
  {
	"City": "Angarsk",
	"Country": "Russia",
	"Population": "265,000"
  },
  {
	"City": "Sterlitamak",
	"Country": "Russia",
	"Population": "264,000"
  },
  {
	"City": "Münster",
	"Country": "Germany",
	"Population": "264,000"
  },
  {
	"City": "Gijón",
	"Country": "Spain",
	"Population": "264,000"
  },
  {
	"City": "LJUBLJANA",
	"Country": "Slovenia",
	"Population": "264,000"
  },
  {
	"City": "Mönchengladbach",
	"Country": "Germany",
	"Population": "263,000"
  },
  {
	"City": "Chemnitz",
	"Country": "Germany",
	"Population": "263,000"
  },
  {
	"City": "Messina",
	"Country": "Italy",
	"Population": "262,000"
  },
  {
	"City": "Walsall",
	"Country": "UK",
	"Population": "262,000"
  },
  {
	"City": "Chernovtsy",
	"Country": "Ukraine",
	"Population": "260,000"
  },
  {
	"City": "Khmelnitsky",
	"Country": "Ukraine",
	"Population": "258,000"
  },
  {
	"City": "Malmö",
	"Country": "Sweden",
	"Population": "257,000"
  },
  {
	"City": "Czestochowa",
	"Country": "Poland",
	"Population": "257,000"
  },
  {
	"City": "Plymouth",
	"Country": "UK",
	"Population": "256,000"
  },
  {
	"City": "Hospitalet de Llobregat",
	"Country": "Spain",
	"Population": "255,050"
  },
  {
	"City": "Rotherham",
	"Country": "UK",
	"Population": "255,000"
  },
  {
	"City": "Augsburg",
	"Country": "Germany",
	"Population": "255,000"
  },
  {
	"City": "Stoke-on-Trent",
	"Country": "UK",
	"Population": "254,000"
  },
  {
	"City": "Halle",
	"Country": "Germany",
	"Population": "254,000"
  },
  {
	"City": "Verona",
	"Country": "Italy",
	"Population": "254,000"
  },
  {
	"City": "Gdynia",
	"Country": "Poland",
	"Population": "254,000"
  },
  {
	"City": "Strasbourg",
	"Country": "France",
	"Population": "252,000"
  },
  {
	"City": "Ploiesti",
	"Country": "Romania",
	"Population": "251,000"
  },
  {
	"City": "Nis",
	"Country": "Serbia",
	"Population": "250,000"
  },
  {
	"City": "Ioshkap-Ola",
	"Country": "Russia",
	"Population": "249,000"
  },
  {
	"City": "Braunschweig",
	"Country": "Germany",
	"Population": "246,000"
  },
  {
	"City": "Nantes",
	"Country": "France",
	"Population": "244,000"
  },
  {
	"City": "Wolverhampton",
	"Country": "UK",
	"Population": "244,000"
  },
  {
	"City": "Rovno",
	"Country": "Ukraine",
	"Population": "244,000"
  },
  {
	"City": "TIRANA",
	"Country": "Albania",
	"Population": "244,000"
  },
  {
	"City": "Aachen",
	"Country": "Germany",
	"Population": "244,000"
  },
  {
	"City": "Sosnowiec",
	"Country": "Poland",
	"Population": "243,000"
  },
  {
	"City": "Granada",
	"Country": "Spain",
	"Population": "243,000"
  },
  {
	"City": "Kosice",
	"Country": "Slovakia",
	"Population": "242,000"
  },
  {
	"City": "Krefeld",
	"Country": "Germany",
	"Population": "241,000"
  },
  {
	"City": "Rybinsk",
	"Country": "Russia",
	"Population": "241,000"
  },
  {
	"City": "La Coruña",
	"Country": "Spain",
	"Population": "241,000"
  },
  {
	"City": "Rhondda",
	"Country": "UK",
	"Population": "240,000"
  },
  {
	"City": "Krementchug",
	"Country": "Ukraine",
	"Population": "238,000"
  },
  {
	"City": "Nizhenvartovsk",
	"Country": "Russia",
	"Population": "238,000"
  },
  {
	"City": "Graz",
	"Country": "Austria",
	"Population": "238,000"
  },
  {
	"City": "Prokopyevsk",
	"Country": "Russia",
	"Population": "236,000"
  },
  {
	"City": "Severodvinsk",
	"Country": "Russia",
	"Population": "236,000"
  },
  {
	"City": "South Gloucestershire",
	"Country": "UK",
	"Population": "235,000"
  },
  {
	"City": "Magdeburg",
	"Country": "Germany",
	"Population": "235,000"
  },
  {
	"City": "Ivano-Frankovsk",
	"Country": "Ukraine",
	"Population": "234,000"
  },
  {
	"City": "Kiel",
	"Country": "Germany",
	"Population": "234,000"
  },
  {
	"City": "Braila",
	"Country": "Romania",
	"Population": "233,000"
  },
  {
	"City": "Derby",
	"Country": "UK",
	"Population": "233,000"
  },
  {
	"City": "Utrecht",
	"Country": "Netherlands",
	"Population": "233,000"
  },
  {
	"City": "Ternopol",
	"Country": "Ukraine",
	"Population": "233,000"
  },
  {
	"City": "Radom",
	"Country": "Poland",
	"Population": "232,000"
  },
  {
	"City": "Gent (Gand)",
	"Country": "Belgium",
	"Population": "230,000"
  },
  {
	"City": "Swansea",
	"Country": "UK",
	"Population": "230,000"
  },
  {
	"City": "Naltchik",
	"Country": "Russia",
	"Population": "230,000"
  },
  {
	"City": "Syktivkar",
	"Country": "Russia",
	"Population": "230,000"
  },
  {
	"City": "Velikiy Novgorod",
	"Country": "Russia",
	"Population": "229,000"
  },
  {
	"City": "Salford",
	"Country": "UK",
	"Population": "229,000"
  },
  {
	"City": "Bergen",
	"Country": "Norway",
	"Population": "228,000"
  },
  {
	"City": "Aberdeenshire",
	"Country": "UK",
	"Population": "227,000"
  }
];
	$.ajaxSetup({
        async: false
    });
	var loopcount =0
	for (var i=0; i<cities.length; i++) {
		var elemDiv = document.createElement('div');
		elemDiv.setAttribute("id",i);
		document.body.appendChild(elemDiv);
		}	
	/*
	//want to be able to hit return
	$('.input').keypress(function (e) {
  		if (e.which == 13) {
    	$('form#searchform').submit();
    	return false;
  		}
		});
		*/
	  $("#search").click(function(){
		for (var k=0; k<cities.length; k++) {
			//clear divs
			$("#"+k).remove()
			var elemDiv = document.createElement('div');
			elemDiv.setAttribute("id",k);
			document.body.appendChild(elemDiv);
			loopcount = k;
			var cityname = cities[k].City;
			var countryname = cities[k].Country;
			$("#"+k).append("<h2>"+cityname+", "+countryname+"</h2>");
// 			$("#"+k).append("<p>Population: " + cities[k].Population);
			$("#"+k).append("<p>Population: " + cities[k].Population + '. <a href="https://google.com/maps?q='+cityname+"+"+countryname+'">Google Maps link</a>. <a href="https://en.wikipedia.org/wiki/'+cityname+'">Wikipedia link.</a></p><div class="images"></div>');
			var tagtext = $("#searchterm");
			$.ajax({
				url: "http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?",
				dataType: 'json',
				qty_input: $(this),
        		div_to_append: loopcount,
				data: {
		  			tags: $("#searchterm").val() + ","+cityname,
					//	tags: "groningen,street",
		  			tagmode: "all",
		  			format: "json"
					},
				async: false,
				success: appendDiv(k)
				/*
				success: function(data) {
					$.each(data.items, function(j,item){
		  				console.log(item.tags);
		  				var divid = this.div_to_append;
						$("<img />").attr("src", item.media.m).prependTo(divid);
						
						console.log(divid);
						if ( j == 10 ) return false;
						});
					}
					*/
				});
		}
	  });
	  
	  var appendDiv = function(index) {
	  	return function(data) {
	  		$.each(data.items, function(j,item){
		  		console.log(item);
		  		var divid = "#" + index + " .images";
		  		var imgid = index + "_" + j;
		  		var htmlToAppend = $("<img />").attr({src: item.media.m, class: "image", id: imgid});
		  		htmlToAppend.prependTo(divid);
		  		$('#'+imgid).wrap('<a href="'+ item.link+'"></a>');
// 				htmlToAppend.prependTo(divid);
// 				$(divid+'img').wrap('<a href="https://google.com></a>');
				console.log(divid);
				if ( j == 10 ) return false;
				});
	  	}
	  }
	